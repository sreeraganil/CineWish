import{j as r,L as n,r as l}from"./index-CZzhZSbx.js";import{w as c,C as d}from"./watchStore-Ctn-oT8I.js";import{L as i}from"./Loader-BAZ1S1mj.js";import{B as h}from"./BackHeader-BbS-zjJy.js";const x=({items:t,onRemove:a})=>t!=null&&t.length?r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-bold mb-4 text-teal-400",children:"Watch History"}),r.jsx("div",{className:"flex gap-4 overflow-x-auto scrollbar-hide scroll-smooth px-2 md:px-5",children:t.map(e=>{const o=e.mediaType==="tv"?`/watch/tv/${e.mediaId}/${e.season}/${e.episode}`:`/watch/movie/${e.mediaId}`;return r.jsxs(n,{to:o,state:{title:e.title,progressSeconds:e.progressSeconds,poster:e.poster,backdrop:e.backdrop},className:"relative group flex-none w-[160px] bg-gray-900 border border-gray-800 rounded-xl overflow-hidden hover:border-teal-400 transition",children:[r.jsx("div",{className:"relative h-[240px] bg-slate-800 overflow-hidden",children:r.jsx("img",{src:e.poster,alt:e.title,onError:s=>{s.currentTarget.src="/placeholder.png"},className:"w-full h-full object-cover group-hover:scale-105 transition-transform"})}),r.jsx("button",{onClick:s=>{s.preventDefault(),s.stopPropagation(),a==null||a(e)},className:`\r
                      absolute top-2 right-2 z-20\r
                      w-6 h-6\r
                      rounded-full\r
                      bg-black/70 text-white\r
                      text-sm\r
                      hover:bg-teal-600\r
                      transition\r
                    `,children:"✕"}),r.jsxs("div",{className:"p-3",children:[r.jsx("h3",{className:"text-sm font-semibold text-white truncate",children:e.title??"Unknown"}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:e.mediaType==="tv"?`S${e.season} • E${e.episode}`:"Movie"}),r.jsx("p",{className:"text-[11px] text-teal-400 mt-1",children:new Date(e.lastWatchedAt).toLocaleDateString()})]})]},`${e.mediaType}-${e.mediaId}-${e.season}-${e.episode}`)})})]}):null,j=()=>{const{continueWatching:t,history:a,loading:e,fetchWatchProgress:o,removeFromHistory:s}=c();return l.useEffect(()=>{o()},[o]),e?r.jsx("div",{className:"h-screen",children:r.jsx(i,{})}):r.jsxs(r.Fragment,{children:[r.jsx(h,{title:"History"}),r.jsxs("div",{className:"min-h-[calc(100%-72px)] bg-slate-950 px-6 pb-8",children:[r.jsx(d,{items:t,onRemove:s}),r.jsx(x,{items:a,onRemove:s})]})]})};export{j as default};
