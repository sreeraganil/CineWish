import{w as y,r as a,a as N,j as e}from"./index-CZzhZSbx.js";import{H as C}from"./Header-CfVJw4Ab.js";import{L as E}from"./Loader-BAZ1S1mj.js";import{D as S}from"./DeleteConfirmModal-BCQUBYAJ.js";import{T as _}from"./index-BiRmOZSn.js";import{C as M}from"./CardSkeleton-BdTlfYOo.js";const A=()=>{const{watched:r,watchedCount:d,fetchWatched:p,removeFromWishlist:u}=y(),[l,x]=a.useState(!1),[o,g]=a.useState(1),[f,i]=a.useState(!1),[j,m]=a.useState(null),n=a.useRef(null),b=N(),h=Math.max(Math.ceil(d.totalCount/20),1);a.useEffect(()=>{(async()=>{x(!0),await p(o),x(!1)})()},[o]),a.useEffect(()=>{const t=new IntersectionObserver(s=>{s[0].isIntersecting&&!l&&o<h&&g(c=>c+1)},{root:null,rootMargin:"600px 0px",threshold:0});return n.current&&t.observe(n.current),()=>{n.current&&t.unobserve(n.current)}},[l,o,h]);const v=(t,s)=>{b(`/details/${t}/${s}`)},w=async()=>{await u(j,"watched"),m(null),i(!1)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-950 to-black text-white pb-20 md:pb-0",children:[e.jsx(C,{}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsxs("h1",{className:"text-2xl font-bold mb-4 flex items-center",children:["Watched",!l&&e.jsx("span",{className:"ml-3 text-lg rounded-full bg-teal-600 px-2",children:d.totalCount})]}),l&&o===1?e.jsx(E,{}):(r==null?void 0:r.length)===0?e.jsxs("div",{className:"w-full flex flex-col items-center justify-center gap-4",children:[e.jsx(_,{src:"/lottie/no_data_found.lottie",loop:!0,autoplay:!0,style:{width:"clamp(100px, 40vw, 200px)",height:"clamp(100px, 40vw, 200px)",borderRadius:"50%",overflow:"hidden",marginTop:"100px"}}),e.jsx("p",{className:"text-gray-400 text-center",children:"You havenâ€™t marked anything as watched."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-7 gap-4",children:[r==null?void 0:r.map((t,s)=>e.jsxs("div",{className:"relative bg-gray-900 border border-gray-800 rounded-lg overflow-hidden shadow hover:shadow-teal-500/20 transition hover:scale-105",onClick:()=>v(t.type,t.tmdbId),children:[e.jsx("img",{src:`https://image.tmdb.org/t/p/w500${t.poster}`,alt:t.title,className:"h-60 w-full object-cover"}),e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"text-sm font-semibold truncate",children:t.title}),e.jsx("p",{className:"text-xs text-gray-400",children:t.year}),e.jsxs("p",{className:"text-xs text-teal-400 mt-1",children:["Rating: ",parseFloat(t.rating).toFixed(1)||"N/A"]})]}),e.jsx("span",{className:"absolute top-2 right-2 bg-teal-600 text-white text-[10px] font-semibold px-2 py-0.5 rounded-full uppercase shadow-md",children:t.type}),e.jsx("button",{className:"absolute z-10 bottom-2 right-2 bg-red-500 p-0.5 rounded flex items-center justify-center hover:bg-red-800",onClick:c=>{c.stopPropagation(),m(t._id),i(!0)},children:e.jsx("span",{className:"material-symbols-outlined",children:"delete"})})]},`${t._id}-${s}`)),l&&Array.from({length:12}).map((t,s)=>e.jsx(M,{},`skeleton-${s}`))]}),e.jsx("div",{ref:n,className:"h-10 mt-4 flex justify-center items-center",children:l&&o>1&&e.jsx("span",{className:"text-teal-400",children:"Loading more..."})})]})]}),e.jsx(S,{isOpen:f,onClose:()=>i(!1),onConfirm:w})]})};export{A as default};
