import{r as s,w as $,a as I,j as e,C as W}from"./index-Dce_IDGO.js";import{H as G}from"./Header-DJnx5VtU.js";import{L as Y}from"./Loader-fqv60wXc.js";import{D as B}from"./DeleteConfirmModal-BzxC6PLz.js";import{T as O}from"./index-C1uyLPS_.js";const Z=()=>{const[o,v]=s.useState(!0),{wishlist:a,wishlistCount:i,fetchWishlist:T,markAsWatched:R,removeFromWishlist:A}=$(),E=I(),[_,d]=s.useState(!1),[H,j]=s.useState(null),[f,b]=s.useState(!1),y=s.useRef(null),[h,w]=s.useState(""),[x,N]=s.useState(""),[u,C]=s.useState(""),[m,F]=s.useState(""),[r,p]=s.useState(1),[c,S]=s.useState(!1),g=[h,x,u,m].filter(Boolean).length,P=()=>{w(""),N(""),C(""),F(""),p(1)},z=()=>{p(1),k(),b(!1)},M=Math.max(Math.ceil((i.filterTotalCount||i.totalCount)/20),1);s.useEffect(()=>{const t=new IntersectionObserver(n=>{n[0].isIntersecting&&!o&&!c&&r<M&&p(V=>V+1)},{root:null,rootMargin:"600px 0px",threshold:0}),l=y.current;return l&&t.observe(l),()=>{l&&t.unobserve(l)}},[o,c,r,M]);const D=(t,l)=>{E(`/details/${t}/${l}`)},k=async()=>{r===1?v(!0):S(!0);const t=new URLSearchParams({t:h,g:x,y:u,r:m}).toString();await T(t,r),v(!1),S(!1)};s.useEffect(()=>{k()},[r]);const L=async()=>{await A(H,"wishlist"),j(null),d(!1)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-950 to-black text-white pb-20 md:pb-0",children:[e.jsx(G,{}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsxs("div",{className:"relative mb-4 flex flex-col items-end",children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("h2",{className:"text-2xl font-bold flex items-center justify-center",children:["Your Wishlist",!o&&e.jsx("span",{className:"ml-3 text-lg rounded-full bg-teal-600 px-2",children:i.filterTotalCount||i.totalCount})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:`material-symbols-outlined cursor-pointer select-none ${f&&"text-teal-500"}`,onClick:()=>b(t=>!t),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",fill:"currentColor",children:e.jsx("path",{d:"M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"})})}),g>0&&e.jsx("span",{className:"absolute rounded-full bg-teal-500 px-1 top-[-30%] right-[-50%] text-xs font-semibold",children:g})]})]}),f&&e.jsxs("div",{className:"mt-4 bg-gray-800 text-white p-4 rounded-lg space-y-4 max-w-lg",children:[e.jsxs("div",{className:"flex gap-4 justify-center flex-wrap",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Type"}),e.jsxs("select",{className:"bg-gray-900 px-2 py-1 rounded",onChange:t=>w(t.target.value),value:h,children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"movie",children:"Movie"}),e.jsx("option",{value:"tv",children:"TV"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Genre"}),e.jsxs("select",{className:"bg-gray-900 px-2 py-1 rounded",onChange:t=>N(t.target.value),value:x,children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"Action",children:"Action"}),e.jsx("option",{value:"Adventure",children:"Adventure"}),e.jsx("option",{value:"Drama",children:"Drama"}),e.jsx("option",{value:"Comedy",children:"Comedy"}),e.jsx("option",{value:"Thriller",children:"Thriller"}),e.jsx("option",{value:"Mystery",children:"Mystery"}),e.jsx("option",{value:"Fantasy",children:"Fantasy"}),e.jsx("option",{value:"Science Fiction",children:"Sci-Fi"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Year"}),e.jsx("input",{type:"number",className:"bg-gray-900 px-2 py-1 rounded w-24",placeholder:"e.g. 2023",value:u,onChange:t=>C(t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Min Rating"}),e.jsx("input",{type:"number",className:"bg-gray-900 px-2 py-1 rounded w-24",step:"0.1",min:"0",max:"10",placeholder:"e.g. 6",value:m,onChange:t=>F(t.target.value)})]})]}),e.jsxs("div",{className:"text-right w-full flex justify-between",children:[e.jsx("button",{onClick:P,className:"px-3 py-[2px] bg-red-600 rounded hover:bg-red-700 transition duration-300",children:"Clear Filters"}),e.jsx("button",{onClick:z,className:"px-3 py-[2px] bg-teal-500 rounded hover:bg-teal-700 transition duration-300",children:"Show Results"})]})]})]}),o?e.jsx(Y,{}):(a==null?void 0:a.length)===0?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative w-full flex flex-col items-center justify-center gap-4",children:[e.jsx(O,{src:"/lottie/no_data_found.lottie",loop:!0,autoplay:!0,style:{width:"clamp(100px, 40vw, 200px)",height:"clamp(100px, 40vw, 200px)",borderRadius:"50%",overflow:"hidden",marginTop:"100px"}}),e.jsx("p",{className:"text-gray-500 text-center",children:g>0?"No results found matching your filters.":"Your wishlist is empty."})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-7 gap-4",children:[a==null?void 0:a.map((t,l)=>e.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded-lg overflow-hidden shadow hover:shadow-teal-500/20 transition hover:scale-105 relative cursor-pointer",onClick:()=>D(t.type,t.tmdbId),children:[e.jsx("img",{src:`https://image.tmdb.org/t/p/w500${t.poster}`,alt:t.title,className:"h-60 w-full object-cover"}),e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"text-sm font-semibold truncate",children:t.title}),e.jsx("p",{className:"text-xs text-gray-400",children:t.year}),e.jsxs("p",{className:"text-xs text-teal-400 mt-1",children:["Rating: ",parseFloat(t.rating).toFixed(1)||"N/A"]}),e.jsxs("div",{className:"relative mt-2 flex items-center justify-between",children:[e.jsx("button",{onClick:n=>{n.stopPropagation(),R(t._id)},className:"w-3/4 bg-teal-600 hover:bg-teal-700 text-white text-xs font-semibold py-1.5 rounded",children:"Watched"}),e.jsx("button",{className:"bg-red-500 p-0.5 rounded flex items-center justify-center hover:bg-red-800",onClick:n=>{n.stopPropagation(),j(t._id),d(!0)},children:e.jsx("span",{className:"material-symbols-outlined",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"22",height:"22",fill:"currentColor",children:e.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})})})})]})]}),e.jsx("span",{className:"absolute top-2 right-2 bg-teal-600 text-white text-[10px] font-semibold px-2 py-0.5 rounded-full uppercase shadow-md",children:t.type})]},`${t._id}-${l}`)),c&&Array.from({length:12}).map((t,l)=>e.jsx(W,{},`skeleton-${l}`))]}),e.jsx("div",{ref:y,className:"h-10 mt-4 flex justify-center items-center",children:c&&r>1&&e.jsx("span",{className:"text-teal-400",children:"Loading more..."})})]})]}),e.jsx(B,{isOpen:_,onClose:()=>d(!1),onConfirm:L})]})};export{Z as default};
