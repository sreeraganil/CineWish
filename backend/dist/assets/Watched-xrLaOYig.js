import{w as y,r as a,a as N,j as e,C}from"./index-Dce_IDGO.js";import{H as E}from"./Header-DJnx5VtU.js";import{L as M}from"./Loader-fqv60wXc.js";import{D as S}from"./DeleteConfirmModal-BzxC6PLz.js";import{T as _}from"./index-C1uyLPS_.js";const D=()=>{const{watched:l,watchedCount:d,fetchWatched:p,removeFromWishlist:g}=y(),[r,x]=a.useState(!1),[o,u]=a.useState(1),[f,i]=a.useState(!1),[j,h]=a.useState(null),n=a.useRef(null),v=N(),m=Math.max(Math.ceil(d.totalCount/20),1);a.useEffect(()=>{(async()=>{x(!0),await p(o),x(!1)})()},[o]),a.useEffect(()=>{const t=new IntersectionObserver(s=>{s[0].isIntersecting&&!r&&o<m&&u(c=>c+1)},{root:null,rootMargin:"600px 0px",threshold:0});return n.current&&t.observe(n.current),()=>{n.current&&t.unobserve(n.current)}},[r,o,m]);const b=(t,s)=>{v(`/details/${t}/${s}`)},w=async()=>{await g(j,"watched"),h(null),i(!1)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-950 to-black text-white pb-20 md:pb-0",children:[e.jsx(E,{}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsxs("h1",{className:"text-2xl font-bold mb-4 flex items-center",children:["Watched",!r&&e.jsx("span",{className:"ml-3 text-lg rounded-full bg-teal-600 px-2",children:d.totalCount})]}),r&&o===1?e.jsx(M,{}):(l==null?void 0:l.length)===0?e.jsxs("div",{className:"w-full flex flex-col items-center justify-center gap-4",children:[e.jsx(_,{src:"/lottie/no_data_found.lottie",loop:!0,autoplay:!0,style:{width:"clamp(100px, 40vw, 200px)",height:"clamp(100px, 40vw, 200px)",borderRadius:"50%",overflow:"hidden",marginTop:"100px"}}),e.jsx("p",{className:"text-gray-400 text-center",children:"You havenâ€™t marked anything as watched."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-7 gap-4",children:[l==null?void 0:l.map((t,s)=>e.jsxs("div",{className:"relative bg-gray-900 border border-gray-800 rounded-lg overflow-hidden shadow hover:shadow-teal-500/20 transition hover:scale-105",onClick:()=>b(t.type,t.tmdbId),children:[e.jsx("img",{src:`https://image.tmdb.org/t/p/w500${t.poster}`,alt:t.title,className:"h-60 w-full object-cover"}),e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"text-sm font-semibold truncate",children:t.title}),e.jsx("p",{className:"text-xs text-gray-400",children:t.year}),e.jsxs("p",{className:"text-xs text-teal-400 mt-1",children:["Rating: ",parseFloat(t.rating).toFixed(1)||"N/A"]})]}),e.jsx("span",{className:"absolute top-2 right-2 bg-teal-600 text-white text-[10px] font-semibold px-2 py-0.5 rounded-full uppercase shadow-md",children:t.type}),e.jsx("button",{className:"absolute z-10 bottom-2 right-2 bg-red-500 p-0.5 rounded flex items-center justify-center hover:bg-red-800",onClick:c=>{c.stopPropagation(),h(t._id),i(!0)},children:e.jsx("span",{className:"material-symbols-outlined",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"22",height:"22",fill:"currentColor",children:e.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})})})})]},`${t._id}-${s}`)),r&&Array.from({length:12}).map((t,s)=>e.jsx(C,{},`skeleton-${s}`))]}),e.jsx("div",{ref:n,className:"h-10 mt-4 flex justify-center items-center",children:r&&o>1&&e.jsx("span",{className:"text-teal-400",children:"Loading more..."})})]})]}),e.jsx(S,{isOpen:f,onClose:()=>i(!1),onConfirm:w})]})};export{D as default};
