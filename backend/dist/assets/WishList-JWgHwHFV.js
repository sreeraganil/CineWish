import{r as s,w as G,a as Y,j as e}from"./index-CZzhZSbx.js";import{H}from"./Header-CfVJw4Ab.js";import{L as O}from"./Loader-BAZ1S1mj.js";import{D as q}from"./DeleteConfirmModal-BCQUBYAJ.js";import{T as B}from"./index-BiRmOZSn.js";import{C as U}from"./CardSkeleton-BdTlfYOo.js";const ee=()=>{const[o,f]=s.useState(!0),{wishlist:a,wishlistCount:i,fetchWishlist:T,markAsWatched:R,removeFromWishlist:A}=G(),E=Y(),[_,d]=s.useState(!1),[P,j]=s.useState(null),[v,b]=s.useState(!1),y=s.useRef(null),[x,N]=s.useState(""),[u,w]=s.useState(""),[h,C]=s.useState(""),[m,F]=s.useState(""),[r,p]=s.useState(1),[c,S]=s.useState(!1),g=[x,u,h,m].filter(Boolean).length,D=()=>{N(""),w(""),C(""),F(""),p(1)},L=()=>{p(1),M(),b(!1)},k=Math.max(Math.ceil((i.filterTotalCount||i.totalCount)/20),1);s.useEffect(()=>{const t=new IntersectionObserver(n=>{n[0].isIntersecting&&!o&&!c&&r<k&&p(W=>W+1)},{root:null,rootMargin:"600px 0px",threshold:0}),l=y.current;return l&&t.observe(l),()=>{l&&t.unobserve(l)}},[o,c,r,k]);const $=(t,l)=>{E(`/details/${t}/${l}`)},M=async()=>{r===1?f(!0):S(!0);const t=new URLSearchParams({t:x,g:u,y:h,r:m}).toString();await T(t,r),f(!1),S(!1)};s.useEffect(()=>{M()},[r]);const I=async()=>{await A(P,"wishlist"),j(null),d(!1)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-950 to-black text-white pb-20 md:pb-0",children:[e.jsx(H,{}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsxs("div",{className:"relative mb-4 flex flex-col items-end",children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("h2",{className:"text-2xl font-bold flex items-center justify-center",children:["Your Wishlist",!o&&e.jsx("span",{className:"ml-3 text-lg rounded-full bg-teal-600 px-2",children:i.filterTotalCount||i.totalCount})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:`material-symbols-outlined cursor-pointer select-none ${v&&"text-teal-500"}`,onClick:()=>b(t=>!t),children:"tune"}),g>0&&e.jsx("span",{className:"absolute rounded-full bg-teal-500 px-1 top-[-30%] right-[-50%] text-xs font-semibold",children:g})]})]}),v&&e.jsxs("div",{className:"mt-4 bg-gray-800 text-white p-4 rounded-lg space-y-4 max-w-lg",children:[e.jsxs("div",{className:"flex gap-4 justify-center flex-wrap",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Type"}),e.jsxs("select",{className:"bg-gray-900 px-2 py-1 rounded",onChange:t=>N(t.target.value),value:x,children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"movie",children:"Movie"}),e.jsx("option",{value:"tv",children:"TV"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Genre"}),e.jsxs("select",{className:"bg-gray-900 px-2 py-1 rounded",onChange:t=>w(t.target.value),value:u,children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"Action",children:"Action"}),e.jsx("option",{value:"Adventure",children:"Adventure"}),e.jsx("option",{value:"Drama",children:"Drama"}),e.jsx("option",{value:"Comedy",children:"Comedy"}),e.jsx("option",{value:"Thriller",children:"Thriller"}),e.jsx("option",{value:"Mystery",children:"Mystery"}),e.jsx("option",{value:"Fantasy",children:"Fantasy"}),e.jsx("option",{value:"Science Fiction",children:"Sci-Fi"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Year"}),e.jsx("input",{type:"number",className:"bg-gray-900 px-2 py-1 rounded w-24",placeholder:"e.g. 2023",value:h,onChange:t=>C(t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Min Rating"}),e.jsx("input",{type:"number",className:"bg-gray-900 px-2 py-1 rounded w-24",step:"0.1",min:"0",max:"10",placeholder:"e.g. 6",value:m,onChange:t=>F(t.target.value)})]})]}),e.jsxs("div",{className:"text-right w-full flex justify-between",children:[e.jsx("button",{onClick:D,className:"px-3 py-[2px] bg-red-600 rounded hover:bg-red-700 transition duration-300",children:"Clear Filters"}),e.jsx("button",{onClick:L,className:"px-3 py-[2px] bg-teal-500 rounded hover:bg-teal-700 transition duration-300",children:"Show Results"})]})]})]}),o?e.jsx(O,{}):(a==null?void 0:a.length)===0?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative w-full flex flex-col items-center justify-center gap-4",children:[e.jsx(B,{src:"/lottie/no_data_found.lottie",loop:!0,autoplay:!0,style:{width:"clamp(100px, 40vw, 200px)",height:"clamp(100px, 40vw, 200px)",borderRadius:"50%",overflow:"hidden",marginTop:"100px"}}),e.jsx("p",{className:"text-gray-500 text-center",children:g>0?"No results found matching your filters.":"Your wishlist is empty."})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-7 gap-4",children:[a==null?void 0:a.map((t,l)=>e.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded-lg overflow-hidden shadow hover:shadow-teal-500/20 transition hover:scale-105 relative cursor-pointer",onClick:()=>$(t.type,t.tmdbId),children:[e.jsx("img",{src:`https://image.tmdb.org/t/p/w500${t.poster}`,alt:t.title,className:"h-60 w-full object-cover"}),e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"text-sm font-semibold truncate",children:t.title}),e.jsx("p",{className:"text-xs text-gray-400",children:t.year}),e.jsxs("p",{className:"text-xs text-teal-400 mt-1",children:["Rating: ",parseFloat(t.rating).toFixed(1)||"N/A"]}),e.jsxs("div",{className:"relative mt-2 flex items-center justify-between",children:[e.jsx("button",{onClick:n=>{n.stopPropagation(),R(t._id)},className:"w-3/4 bg-teal-600 hover:bg-teal-700 text-white text-xs font-semibold py-1.5 rounded",children:"Watched"}),e.jsx("button",{className:"bg-red-500 p-0.5 rounded flex items-center justify-center hover:bg-red-800",onClick:n=>{n.stopPropagation(),j(t._id),d(!0)},children:e.jsx("span",{className:"material-symbols-outlined",children:"delete"})})]})]}),e.jsx("span",{className:"absolute top-2 right-2 bg-teal-600 text-white text-[10px] font-semibold px-2 py-0.5 rounded-full uppercase shadow-md",children:t.type})]},`${t._id}-${l}`)),c&&Array.from({length:12}).map((t,l)=>e.jsx(U,{},`skeleton-${l}`))]}),e.jsx("div",{ref:y,className:"h-10 mt-4 flex justify-center items-center",children:c&&r>1&&e.jsx("span",{className:"text-teal-400",children:"Loading more..."})})]})]}),e.jsx(q,{isOpen:_,onClose:()=>d(!1),onConfirm:I})]})};export{ee as default};
